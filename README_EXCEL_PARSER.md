# ExcelParser - –ü–∞—Ä—Å–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤

–ú–æ–¥—É–ª—å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –≥—Ä—É–∑–∞—Ö, –∑–∞–∫–∞–∑–∞—Ö –∏ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ Excel —Ñ–∞–π–ª–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –æ –≥—Ä—É–∑–∞—Ö (–æ–±—ä–µ–º, –≤–µ—Å, –¥–ª–∏–Ω–∞, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö (–Ω–æ–º–µ—Ä, –¥–∞—Ç–∞, –≤—Ä–µ–º—è, –∫–ª–∏–µ–Ω—Ç)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ (–¥–∞—Ç–∞, –≤—Ä–µ–º—è, ID)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ Telegram

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ú–æ–¥—É–ª—å —É–∂–µ –≤–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `src/parsers/excelParser.js`.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è

```javascript
import ExcelParser from './src/parsers/excelParser.js';
```

### –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### –ü–∞—Ä—Å–∏–Ω–≥ –≥—Ä—É–∑–∞

```javascript
const cargoData = "3.32 –∫—É–±.–º/871 –∫–≥/1.010 –º/–ù–µ—Ç";
const cargo = ExcelParser.parseCargo(cargoData);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// {
//   volume: 3.32,
//   weight: 871,
//   length: 1.01,
//   additionalInfo: '–ù–µ—Ç'
// }
```

#### –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–∫–∞–∑–∞

```javascript
const orderData = "13908.–ó–∞–∫–∞–∑–∞–Ω–æ.01\\.09\\.2025 00:00:00.–ö—É–ª—É—à–æ–≤ –ú–∞—Ä–∞—Ç –®–∞–π–ª–æ–æ–±–∞–µ–≤–∏—á........01\\.09\\.2025 01:30:00..202";
const order = ExcelParser.parseOrder(orderData);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// {
//   orderNumber: '13908',
//   orderDate: '01.09.2025',
//   orderTime: '00:00:00',
//   customerName: '–ö—É–ª—É—à–æ–≤ –ú–∞—Ä–∞—Ç –®–∞–π–ª–æ–æ–±–∞–µ–≤–∏—á',
//   deliveryDate: '01.09.2025',
//   deliveryTime: '01:30:00',
//   deliveryId: '202'
// }
```

#### –ü–∞—Ä—Å–∏–Ω–≥ –º–∞—Ä—à—Ä—É—Ç–∞

```javascript
const routeData = "01.09.25_77_00—á_–í–ò–ü_19";
const route = ExcelParser.parseRoute(routeData);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// {
//   date: '01.09.25',
//   region: '77',
//   time: '00—á',
//   type: '–í–ò–ü',
//   number: '19'
// }
```

### –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫–∏

```javascript
const rowData = [
  "01.09.25_77_00—á_–í–ò–ü_19",
  "3.32 –∫—É–±.–º/871 –∫–≥/1.010 –º/–ù–µ—Ç",
  "13908.–ó–∞–∫–∞–∑–∞–Ω–æ.01\\.09\\.2025 00:00:00.–ö—É–ª—É—à–æ–≤ –ú–∞—Ä–∞—Ç –®–∞–π–ª–æ–æ–±–∞–µ–≤–∏—á........01\\.09\\.2025 01:30:00..202",
  '–û–û–û "–ì–†–£–ó –°–ï–†–í–ò–°"'
];

const fullData = ExcelParser.parseRow(rowData);
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```javascript
const isValid = ExcelParser.validate(fullData);
if (isValid) {
  console.log('–î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã');
} else {
  console.log('–î–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–∫–∏');
}
```

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã–≤–æ–¥–∞

```javascript
const formatted = ExcelParser.format(fullData);
console.log(formatted);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// üì¶ **–ó–∞–∫–∞–∑ ‚Ññ13908**
// üë§ **–ö–ª–∏–µ–Ω—Ç**: –ö—É–ª—É—à–æ–≤ –ú–∞—Ä–∞—Ç –®–∞–π–ª–æ–æ–±–∞–µ–≤–∏—á
// üìÖ **–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞**: 01.09.2025 00:00:00
// üöö **–î–æ—Å—Ç–∞–≤–∫–∞**: 01.09.2025 01:30:00
// üìè **–ì—Ä—É–∑**: 3.32 –∫—É–±.–º, 871 –∫–≥, 1.01 –º
// üìç **–ú–∞—Ä—à—Ä—É—Ç**: 01.09.25 77 00—á
```

## –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

### –ì—Ä—É–∑
–§–æ—Ä–º–∞—Ç: `{–æ–±—ä–µ–º} –∫—É–±.–º/{–≤–µ—Å} –∫–≥/{–¥–ª–∏–Ω–∞} –º/{–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è_–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è}`

–ü—Ä–∏–º–µ—Ä: `3.32 –∫—É–±.–º/871 –∫–≥/1.010 –º/–ù–µ—Ç`

### –ó–∞–∫–∞–∑
–§–æ—Ä–º–∞—Ç: `{–Ω–æ–º–µ—Ä}.–ó–∞–∫–∞–∑–∞–Ω–æ.{–¥–∞—Ç–∞} {–≤—Ä–µ–º—è}.{–∏–º—è_–∫–ª–∏–µ–Ω—Ç–∞}........{–¥–∞—Ç–∞_–¥–æ—Å—Ç–∞–≤–∫–∏} {–≤—Ä–µ–º—è_–¥–æ—Å—Ç–∞–≤–∫–∏}..{ID}`

–ü—Ä–∏–º–µ—Ä: `13908.–ó–∞–∫–∞–∑–∞–Ω–æ.01\.09\.2025 00:00:00.–ö—É–ª—É—à–æ–≤ –ú–∞—Ä–∞—Ç –®–∞–π–ª–æ–æ–±–∞–µ–≤–∏—á........01\.09\.2025 01:30:00..202`

### –ú–∞—Ä—à—Ä—É—Ç
–§–æ—Ä–º–∞—Ç: `{–¥–∞—Ç–∞}_{—Ä–µ–≥–∏–æ–Ω}_{–≤—Ä–µ–º—è}_{—Ç–∏–ø}_{–Ω–æ–º–µ—Ä}`

–ü—Ä–∏–º–µ—Ä: `01.09.25_77_00—á_–í–ò–ü_19`

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ú–æ–¥—É–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`\.`)
- –ù–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `null`, –∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `test_excel_parser.mjs`:

```bash
node test_excel_parser.mjs
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º

–ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram –±–æ—Ç–æ–º –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è:

1. –ü–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö Excel —Ñ–∞–π–ª–æ–≤
2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
3. –í–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –±–∞–∑—É
4. –û–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫

## –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```javascript
// –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ Excel —Ñ–∞–π–ª–∞
bot.on('document', async (msg) => {
  if (msg.document.mime_type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –ø–∞—Ä—Å–∏–º Excel —Ñ–∞–π–ª
    const rows = await parseExcelFile(msg.document.file_id);
    
    for (const row of rows) {
      const parsedData = ExcelParser.parseRow(row);
      
      if (ExcelParser.validate(parsedData)) {
        const formatted = ExcelParser.format(parsedData);
        await bot.sendMessage(msg.chat.id, formatted, { parse_mode: 'Markdown' });
      } else {
        await bot.sendMessage(msg.chat.id, '‚ùå –û—à–∏–±–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∏');
      }
    }
  }
});
```
